{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="{% static 'css/user-profile.css' %}">
    <link rel="icon" href="{% static 'images/ticket logo purple png.png' %}" type="image/icon type">
    <title>Outinz User Panel</title>
</head>
<body>
    <div class="loader">
        <div class="loader-inner">
            <span></span>
            <span></span>
            <span></span>
            <span></span>
        </div>
    </div>
    <div class="container" style="display:none">
        <aside class="userPanel-menu">
            <ul>
                <div class="top-menu">
                    
                    <li data-targetMenu="user-profile" title="Profile">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H512c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zm80 256h64c44.2 0 80 35.8 80 80c0 8.8-7.2 16-16 16H80c-8.8 0-16-7.2-16-16c0-44.2 35.8-80 80-80zm96-96c0 35.3-28.7 64-64 64s-64-28.7-64-64s28.7-64 64-64s64 28.7 64 64zm128-32H496c8.8 0 16 7.2 16 16s-7.2 16-16 16H368c-8.8 0-16-7.2-16-16s7.2-16 16-16zm0 64H496c8.8 0 16 7.2 16 16s-7.2 16-16 16H368c-8.8 0-16-7.2-16-16s7.2-16 16-16zm0 64H496c8.8 0 16 7.2 16 16s-7.2 16-16 16H368c-8.8 0-16-7.2-16-16s7.2-16 16-16z"/></svg>
                        <p>Profile</p>
                    </li>
                    <li data-targetMenu="user-purchased-tickets" title="Purchased Tickets">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M64 64C28.7 64 0 92.7 0 128v80c26.5 0 48 21.5 48 48s-21.5 48-48 48v80c0 35.3 28.7 64 64 64H512c35.3 0 64-28.7 64-64V304c-26.5 0-48-21.5-48-48s21.5-48 48-48V128c0-35.3-28.7-64-64-64H64zm64 96l0 192H448V160H128zm-32 0c0-17.7 14.3-32 32-32H448c17.7 0 32 14.3 32 32V352c0 17.7-14.3 32-32 32H128c-17.7 0-32-14.3-32-32V160z"/></svg>
                        <p>Purchased Tickets</p>
                    </li>
                    <li class="active" data-targetMenu="user-shopping-cart" title="Basket">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M0 24C0 10.7 10.7 0 24 0H69.5c22 0 41.5 12.8 50.6 32h411c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3H170.7l5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5H488c13.3 0 24 10.7 24 24s-10.7 24-24 24H199.7c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5H24C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"/></svg>
                        <p>Basket</p>
                    </li>
                </div>
                <div class="bottom-menu" >
                    <li title="log out" class="log-out">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M160 96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96C43 32 0 75 0 128V384c0 53 43 96 96 96h64c17.7 0 32-14.3 32-32s-14.3-32-32-32H96c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32h64zM504.5 273.4c4.8-4.5 7.5-10.8 7.5-17.4s-2.7-12.9-7.5-17.4l-144-136c-7-6.6-17.2-8.4-26-4.6s-14.5 12.5-14.5 22v72H192c-17.7 0-32 14.3-32 32l0 64c0 17.7 14.3 32 32 32H320v72c0 9.6 5.7 18.2 14.5 22s19 2 26-4.6l144-136z"/></svg>
                        <p>Log Out</p>
                    </li>
                </div>
            </ul>
        </aside>

        <div class="content">
            <div class="sections">              
                <span><a href="{% url 'home:home' %}">Home</a> / <a href=".">User Panel</a></span>
            </div>
            <!-- user profile section -->
            <section class="user-profile" style="display:none;">
                <!-- user change information-->
                <div class="user-change-informations">
                    <div class="user-informations-title">
                        <h2>General Information</h2>
                    </div>
                    <form action="" method="post" class="user-informations-inputs">
                        {% csrf_token %}
                        <ul class="tips">
                            <li class="tip">Please enter your details carefully so you don't run into problems later</li>
                            <li class="tip">All inputs aren't required . just enter the information you want to change</li>
                            <li class="tip">The maximum length of the username should be 15 characters</li>
                        </ul>
                        <div class="inputs">
                            <div class="input">
                                {{form.fname}}
                                <span class="input-title">First Name</span>
                            </div>
                            <div class="input">
                                {{form.lname}}
                                <span class="input-title">Last Name</span>
                            </div>
                        </div>
                        <button type="submit" class="submit">Save All</button>
                    </form>
                    {% if messages %}
                    <div class="success-modal active">
                        <div class="success">
                            <div class="icon">
                                <img src="{% static 'images/successfull.gif' %}" alt="seccessfull">
                            </div>
                            <p class="message">
                                {% for message in messages %}
                                {{message}}
                                {% endfor %}</p>
                            <div class="close-modalBtn">
                                <button>Okay</button>
                            </div>
                        </div>
                    </div>
                    {% endif %}
                    
                </div>
                <!-- user informations -->
                <div class="user-informations">
                    <div class="user-profile-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M272 304h-96C78.8 304 0 382.8 0 480c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32C448 382.8 369.2 304 272 304zM48.99 464C56.89 400.9 110.8 352 176 352h96c65.16 0 119.1 48.95 127 112H48.99zM224 256c70.69 0 128-57.31 128-128c0-70.69-57.31-128-128-128S96 57.31 96 128C96 198.7 153.3 256 224 256zM224 48c44.11 0 80 35.89 80 80c0 44.11-35.89 80-80 80S144 172.1 144 128C144 83.89 179.9 48 224 48z"/></svg>
                    </div>
                    <div class="user-infos">
                        <div class="user-info">
                            <h4 class="title">First Name</h4>
                            <span class="userInfo">{{customer.fname}}</span>
                        </div>
                        <div class="user-info">
                            <h4 class="title">Last Name</h4>
                            <span class="userInfo">{{customer.lname}}</span>
                        </div>
                        <div class="user-info">
                            <h4 class="title">User Name</h4>
                            <span class="userInfo">{{customer.user}}</span>
                        </div>
                        <div class="user-info">
                            <h4 class="title">Email</h4>
                            <span class="userInfo">{{customer.email}}</span>
                        </div>
                    </div>
                </div>
                <!-- purchased tickets -->
                <div class="user-purchased-ticket-sc">
                    <table>
                        <thead>
                            <tr>
                                <th>Ticket Type</th>
                                <th>Ticket Store</th>
                                <th>Start Date</th>
                                <th>Start Hour</th>
                            </tr>
                        </thead>

                        <tbody>
                            {% for item in cart_items %}
                            {% if item.is_ordered is True %}
                            <tr>
                                <td>{{item.product.name}} Party</td>
                                <td>{{item.product.provider.name}}</td>
                                <td>{{item.product.start_date|date:'d/m/Y'}}</td>
                                <td>{{item.product.start_date|date:'g:i a'}}</td>
                            </tr>
                            {% endif %}
                            {% endfor %}
                        </thead>
                    </table>
                </div>
            </section>
            <!-- user purchased tickets section -->
            <section class="user-purchased-tickets" style="display:none;">
                <table class="tickets-table">
                    <thead>
                        <tr>
                            <th>Ticket Type</th>
                            <th>ticket Status</th>
                            <th>Ticket Store Name</th>
                            <th>Store Address</th>
                            <th>Ticket Start Date</th>
                            <th>Ticket Start Hour</th>
                            <th>ticket Purchase Date</th>
                            <th>Ticket Price</th>
                            <th>Show Ticket</th>
                        </tr>
                    </thead>

                    <tbody>
                        {% for item in cart_items %}
                        {% if item.is_ordered is True %}
                        <tr>
                            <td>{{item.product.name}} Party</td>
                            <td class="ticket-status-td">{{item.product.get_status_display}}</td>
                            <td>{{item.product.provider.name}}</td>
                            <td>{{item.product.provider.address}}</td>
                            <td>{{item.product.start_date|date:'d/m/Y'}}</td>
                            <td>{{item.product.start_date|date:'g:i a'}}</td>
                            <td>{{item.created_date|date:'d/m/Y'}}</td>
                            <td>{{item.total_price}} ₺</td>
                            <td>
                                <button onclick="window.location.href='/party/party-ticket/{{item.product.id}}/'" class="show-ticket-btn">Show Ticket</button>
                            </td>
                        </tr>
                        {% endif %}
                        {% endfor %}
                    </tbody>
                </table>
            </section>
            <!-- user shopping cart Section-->
            <section class="user-shopping-cart">
                <div class="user-shopping-cart-title">
                {% if cart.is_empty is False %}
                    <h2>Shopping Cart</h2>
                {% else %}
                    <h2>Your shopping cart is empty</h2>
                {% endif %}
                </div>
                <div class="user-shopping-cart-content">
                    <!-- all cost -->
                    <div class="left-content">
                        <div class="purchase-tips">
                            <h3 class="purchase-tips-title">Pay attention to these points before buying</h3>
                            <ul>
                                <li><span>- </span> After purchase, your name will be registered as a ticket buyer in the store.</li>
                                <li><span>- </span> In order not to forget the date of the purchased ticket, Outinz team suggests that you write it somewhere. Also, the date and complete information of the purchased ticket can be seen in the user panel in the purchased tickets section.</li>
                                <li><span>- </span> If a ticket is canceled for any reason. You can access the address of the store by entering the user panel in the purchased tickets section and receive your payment by referring to that location.</li>

                            </ul>
                        </div>
                        <div class="all-price">
                            <div class="price-title">
                                Total Cost
                            </div>
                            <div class="allPrice">
                                {{cart.total_price}}<span> ₺</span>
                            </div>
                        </div>
                    </div>
                    <!-- shopping carts -->
                    <div class="right-content">
                       <div class="carts">
                        {% for item in cart_items %} 
                        {% if item.is_ordered == False %}                     
                            <div class="cart-detail">
                                <div class="ticket-titles">
                                    <div class="category">Party</div>
                                    <div class="ticket-title">{{item.product.name}}</div>
                                </div>
                                <div class="ticket-details">
                                    <div class="ticket-date">
                                        <div class="ticket-start-date">{{item.product.start_date|date:'Y/m/d'}}</div>
                                        <span> at </span> 
                                        <div class="ticket-time">{{item.product.start_date|date:'g:i a'}}</div>
                                    </div>
                                    <div class="ticket-count">
                                        <div class="ticket-count">
                                            <span class="decrease-icon ticket-count-icon" onclick="window.location.href='/account/decrease-quantity/{{item.id}}/'">-</span>
                                            <input type="number" name="product_quantity" value="{{item.quantity}}" disabled="disabled" class="ticket-counter">
                                            <span class="increase-icon ticket-count-icon" onclick="window.location.href='/account/increase-quantity/{{item.id}}/'">+</span>
                                        </div>
                                    </div>
                                    <div class="ticket-price">{{item.total_price}}<span>₺</span></div>
                                    <div class="ticket-delete" onclick="window.location.href='/account/remove-from-cart/{{item.id}}/'">&times;</div>
                                </div>
                            </div>
                        {% endif %}
                        {% endfor %}
                       </div>
                       <div class="btns">
                        <a href="{% url 'home:home' %}">
                            <button class="back-to-store">Back To Shopping</button>
                        </a>
                        {% if cart.is_empty is False %}
                        <a href="{% url 'payment:create_product'%}">
                            <button class="purchase">Purchase</button>
                        </a>
                        {% endif %}
                       </div>
                    </div>
                </div>
            </section>
        </div>
    </div>
    <div class="logout-modal">
        <div class="content">
            <h3>Log out of the account</h3>
            <p>Do you want to log out of your account?</p>
        </div>
        <div class="btns">
            <button type="button" class="cancel-btn">Cancel</button>
            <button type="button" onclick="window.location.href='/account/logout/'" class="logout-btn">Log Out</button>
        </div>
    </div>
    <script src="{% static 'js/user-profile.js' %}"></script>
</body>
</html>
